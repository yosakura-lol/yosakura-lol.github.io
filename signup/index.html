<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yosakura - Sign Up</title>
    <link rel="icon" type="image/png" sizes="180x180" href="images/LogoP.png">
    <style>
        @keyframes slideInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: 'Montserrat', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-weight: 200;
            background-color: #0d0d0d; 
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .auth-card {
            background: rgb(30, 30, 30);
            backdrop-filter: blur(12px);
            width: 380px; /* Largeur fixe pour PC */
            padding: 130px 35px 30px 35px;
            border-radius: 20px;
            border: 1px solid #828282a3;
            text-align: center;
            position: relative;
            z-index: 2;
            color: white;
            animation: slideInDown 0.8s cubic-bezier(0.2,1,0.2,1) forwards;
            box-sizing: border-box; /* Assure que le padding ne dépasse pas */
        }

        /* AJUSTEMENT POUR TÉLÉPHONE */
        @media screen and (max-width: 480px) {
            .auth-card {
                width: 90%; /* Bords moins larges sur mobile */
                padding: 110px 25px 25px 25px; /* Padding légèrement réduit */
            }
            .site-logo {
                width: 240px; /* Logo un peu plus petit sur mobile */
                top: -160px;
            }
        }

        .reveal { opacity: 0; animation: slideInDown 0.8s cubic-bezier(0.2,1,0.2,1) forwards; }
        .del-1 { animation-delay: 0.1s; }
        .del-2 { animation-delay: 0.3s; }
        .del-3 { animation-delay: 0.5s; }
        .del-4 { animation-delay: 0.7s; }
        .del-5 { animation-delay: 0.9s; }
        .del-6 { animation-delay: 1.1s; }
        .del-7 { animation-delay: 1.3s; }
        .del-8 { animation-delay: 1.5s; }

        .site-logo {
            position: absolute;
            top: -150px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: auto;
            filter: drop-shadow(0 0 10px rgba(255,105,180,0.42))
                    drop-shadow(0 0 20px rgba(255,105,180,0.48))
                    drop-shadow(0 0 30px rgba(255,105,180,0.45));
        }

        .subtitle {
            color: #ccc;
            font-size: 13px;
            margin-bottom: 45px;
            line-height: 1.6;
        }

        .input-group {
            text-align: left;
            margin-bottom: 24px;
            position: relative;
        }

        .input-label {
            display: block;
            font-size: 11px;
            color: #aaa;
            margin-bottom: 8px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group img {
            position: absolute;
            left: 12px;
            top: 40px; /* Ajusté pour l'alignement */
            width: 18px;
            height: 18px;
            pointer-events: none;
            filter: invert(70%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(90%) contrast(100%);
        }

        .form-input {
            width: 100%;
            padding: 15px 15px 15px 40px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.03);
            border-radius: 12px;
            color: white;
            box-sizing: border-box;
            outline: none;
            transition: 0.3s;
            font-size: 14px;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: rgba(255,105,180,0.05);            
            color: #ff69b4;
            border: 1px solid rgba(255,105,180,0.3);
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: rgba(255,105,180,0.1);
            color: #ff85c1; 
            transform: translateY(-2px);
        }

        .footer-link {
            color: #bbb;
            font-size: 12px;
            margin-top: 30px;
            display: block;
            text-decoration: none;
        }

        .footer-link span { color: #ff69b4; font-weight: bold; }
        .footer-link span:hover { text-decoration: underline; }

        .error-msg {
            color: #ff4c4c;
            font-size: 13px;
            margin-top: 12px;
            font-weight: 700;
            display: none;
            text-align: center;
        }

        .tos-group { margin-bottom: 5px; }
        .tos-checkbox { display: flex; align-items: center; gap: 12px; cursor: pointer; font-size: 12px; color: #aaa; text-align: left; }
        .tos-checkbox input { display: none; }
        .custom-checkbox { width: 16px; height: 16px; background: rgba(0,0,0,0.6); border: 1px solid #666; border-radius: 3px; position: relative; flex-shrink: 0; }
        .tos-checkbox input:checked + .custom-checkbox { background: #ff69b4; border-color: #ff69b4; }
        .tos-checkbox input:checked + .custom-checkbox::after { content: '✓'; color: white; font-size: 12px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -55%); }
        .tos-text a { color: #ff69b4; text-decoration: none; font-weight: 600; }

        img { user-select: none; pointer-events: none; }
    </style>
</head>
<body>
    <div class="auth-card">
        <h2 class="title reveal del-1">
            <img src="images/logo.png" alt="Yosakura Logo" class="site-logo">
        </h2>

        <p class="subtitle reveal del-2">creat an account with yosakura.lol.</p>

        <div class="input-group reveal del-3">
            <label class="input-label">Username</label>
            <img src="images/username.png" alt="icon">
            <input type="text" id="username" class="form-input" placeholder="Choose a username">
        </div>

        <div class="input-group reveal del-4">
            <label class="input-label">E-Mail</label>
            <img src="images/email.png" alt="icon">
            <input type="email" id="email" class="form-input" placeholder="name@example.com">
        </div>

        <div class="input-group reveal del-5">
            <label class="input-label">Password</label>
            <img src="images/password.png" alt="icon">
            <input type="password" id="pass" class="form-input" placeholder="Minimum 6 characters">
        </div>

        <div class="input-group tos-group reveal del-6">
            <label class="tos-checkbox">
                <input type="checkbox" id="tosCheck">
                <span class="custom-checkbox"></span>
                <span class="tos-text">You need to accept the <a href="/terms" target="_blank" rel="noopener">ToS</a></span>
            </label>
        </div>

        <button class="submit-btn reveal del-7" id="signupBtn">Create Account</button>
        <div id="errorMsg" class="error-msg"></div>

        <a href="/login" class="footer-link reveal del-8">
            Already have an account? <span>Login</span>
        </a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC8hhDek0GuNk8y9e23l8lGf4PQ2cj_Hzc",
            authDomain: "fir-deffe.firebaseapp.com",
            projectId: "fir-deffe",
            storageBucket: "fir-deffe.firebasestorage.app",
            messagingSenderId: "758364730866",
            appId: "1:758364730866:web:feae96430aa5b8512da76b"
        };

        const auth = getAuth(initializeApp(firebaseConfig));
        const errorMsg = document.getElementById('errorMsg');

        document.getElementById('signupBtn').onclick = async () => {
            errorMsg.style.display = "none";
            const tosAccepted = document.getElementById('tosCheck').checked;
            if(!tosAccepted) {
                errorMsg.textContent = "You must accept the ToS to create an account.";
                errorMsg.style.display = "block";
                return;
            }

            try {
                const username = document.getElementById('username').value.trim();
                const email = document.getElementById('email').value;
                const pass = document.getElementById('pass').value;
                if(!username) {
                    errorMsg.textContent = "Veuillez choisir un nom d'utilisateur.";
                    errorMsg.style.display = "block";
                    return;
                }
                const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
                await updateProfile(userCredential.user, { displayName: username });
                window.location.href = "/";
            } catch(e) {
                errorMsg.textContent = e.message;
                errorMsg.style.display = "block";
            }
        };
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>
